<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Линии сюжета</title>

  <link rel="stylesheet" href="style.css">

  <!-- Firebase compat SDK (подходит для GitHub Pages) -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
</head>
<body>
  <header class="app-header">
    <h1>Линии сюжета</h1>
    <p class="subtitle">Эстафетное креативное письмо в параллельных линиях</p>
  </header>

  <main class="container">

    <!-- Блок: старт -->
    <section class="card">
      <h2>Продолжи историю</h2>
      <p>
        Нажми кнопку ниже — тебе случайно выпадет линия сюжета.
        Прочитай последние фрагменты и добавь свой.
      </p>
      <button id="get-line-btn" class="btn primary">Получить линию</button>
    </section>

    <!-- Блок: текущая линия -->
    <section id="line-card" class="card">
      <div class="line-header-row">
        <div>
          <h2 id="line-title">Линия не выбрана</h2>
          <p id="line-description" class="desc">
            Нажми «Получить линию», чтобы начать.
          </p>
        </div>

        <button id="change-line-btn" class="btn secondary" disabled>
          Другая линия
        </button>
      </div>

      <div class="mode-row">
        <div>
          <p id="online-indicator" class="small muted">
            Режим: локальный (данные только на этом устройстве)
          </p>
        </div>
        <label class="toggle">
          <input type="checkbox" id="online-toggle">
          <span class="toggle-slider"></span>
          <span class="toggle-label-text small">Онлайн-синхронизация</span>
        </label>
      </div>

      <h3>Последние фрагменты</h3>
      <div id="entries-list" class="entries empty">
        <p>Пока нет данных — выбери линию.</p>
      </div>

      <h3>Твоё продолжение</h3>
      <textarea id="entry-input" placeholder="Напиши продолжение..." rows="3"></textarea>
      <button id="add-entry-btn" class="btn primary" disabled>Добавить</button>

      <p id="status-message" class="status"></p>
    </section>

    <!-- Блок: обзор + добавление своей линии + выгрузка и сброс -->
    <section class="card">
      <div class="card-header-row">
        <div>
          <h2>Обзор линий</h2>
          <p class="desc">Каждая линия развивается отдельно. Можно продолжать любую из них.</p>
        </div>
        <div class="card-header-actions">
          <button id="download-btn" class="btn secondary small-btn">
            Скачать всё (.txt)
          </button>
          <button id="reset-btn" class="btn secondary small-btn danger-btn">
            Начать сначала
          </button>
        </div>
      </div>

      <div id="overview-grid" class="grid"></div>

      <hr class="divider">

      <h3>Создать свою линию</h3>
      <p class="small muted">
        Выбери персонажа из списка или придумай своего, добавь описание и создай новую ветку.
      </p>

      <div class="new-line-form">
        <div class="field">
          <label for="persona-select">Персонаж из списка</label>
          <select id="persona-select">
            <option value="Путешественник">Путешественник</option>
            <option value="Наблюдатель">Наблюдатель</option>
            <option value="Шутник">Шутник</option>
            <option value="Учёный">Учёный</option>
            <option value="Скептик">Скептик</option>
            <option value="Мечтатель">Мечтатель</option>
          </select>
        </div>

        <div class="field">
          <label for="persona-custom">Или свой персонаж</label>
          <input id="persona-custom" type="text" placeholder="Например: Хранитель истории">
        </div>

        <div class="field">
          <label for="line-desc-input">Краткое описание линии</label>
          <input id="line-desc-input" type="text" placeholder="О чём эта линия?">
        </div>

        <button id="add-line-btn" class="btn primary">Создать линию</button>
        <p id="new-line-status" class="status"></p>
      </div>
    </section>

  </main>

  <script src="script.js"></script>
</body>
</html>
